<erupt-page-header></erupt-page-header>
<div nz-row [nzGutter]="16" *ngIf="eruptBuildModel">
    <div nz-col [nzXs]="24" [nzSm]="8" [nzMd]="8" [nzLg]="6">
        <button nz-button nzType="dashed" style="display:block;width: 100%;" (click)="addBlock()" class="mb-sm"
                *ngIf="eruptBuildModel.eruptModel.eruptJson.power.add">
            <i nz-icon nzType="plus" theme="outline"></i> 新增
        </button>
        <nz-input-group [nzSuffix]="suffixIcon" class="mb-sm" style="width: 100%;">
            <input type="text" nz-input placeholder="Search" [(ngModel)]="searchValue">
        </nz-input-group>
        <ng-template #suffixIcon>
            <i nz-icon nzType="search"></i>
        </ng-template>
        <br>
        <nz-card [nzBodyStyle]="{padding:'10px',height:'calc(100vh - 220px)',overflow: 'auto'}"
                 [nzLoading]="treeLoading"
                 [nzBordered]="true"
                 [nzHoverable]="true">
            <nz-tree #tree
                     class="tree-container"
                     [nzShowLine]="true"
                     [nzData]="nodes"
                     [nzSearchValue]="searchValue"
                     [nzBlockNode]="true"
                     (nzClick)="nodeClickEvent($event)"
                     (nzDblClick)="nzDblClick($event)"
            >
            </nz-tree>
        </nz-card>
    </div>
    <div nz-col class="mb-sm" [nzXs]="24" [nzSm]="16" [nzMd]="16" [nzLg]="18" [hidden]="!showEdit">
        <ng-container>
            <div nz-row class="mb-sm">
                <div nz-col [nzXs]="24">
                <span [hidden]="!selectLeaf">
                    <button nz-button (click)="save()" [disabled]="loading"
                            *ngIf="eruptBuildModel.eruptModel.eruptJson.power.edit">
                        <i nz-icon nzType="save" theme="outline"></i>保存
                    </button>
                    <button nz-button nzType="danger" style="background: #fff !important;" [nzGhost]="true"
                            (click)="del()" [disabled]="loading"
                            *ngIf="eruptBuildModel.eruptModel.eruptJson.power.delete">
                        <i nz-icon nzType="delete" theme="outline"></i>删除
                    </button>
                    <button nz-button nzType="dashed" (click)="addSub()" [disabled]="loading" *ngIf="eruptBuildModel.eruptModel.eruptJson.power.add
                    &&eruptBuildModel.eruptModel.eruptJson.tree.pid">
                        <i nz-icon nzType="arrow-down" nzTheme="outline"></i>增加下级
                    </button>
                </span>
                    <span [hidden]="selectLeaf">
                    <button nz-button (click)="add()" [disabled]="loading"
                            *ngIf="eruptBuildModel.eruptModel.eruptJson.power.add">
                        <i nz-icon nzType="plus" theme="outline"></i>增加
                    </button>
                </span>
                    <button class="float-right" nz-button nzType="danger" nzGhost
                            style="background: #fff !important;"
                            (click)="showEdit=false" [disabled]="loading"
                            *ngIf="showEdit">
                        <i nz-icon nzType="close" theme="outline"></i>
                    </button>
                </div>
            </div>
            <div [ngStyle]="{overflow: 'auto',overflowX:'hidden'}" style="height:calc(100vh - 180px)">
                <nz-collapse nzAccordion>
                    <nz-collapse-panel [nzActive]="true" [nzHeader]="'基本信息'" [nzDisabled]="true">
                        <nz-spin [nzSpinning]="loading" nzSize="large">
                            <erupt-edit [eruptBuildModel]="eruptBuildModel">

                            </erupt-edit>
                        </nz-spin>
                    </nz-collapse-panel>
                </nz-collapse>
            </div>
        </ng-container>
    </div>
</div>
